# Лабораторная работа №1 «Основы работы с EcoRouter»

## Тема: Настройка базовых функций маршрутизатора EcoRouter

## Цель работы:
Освоить основные команды настройки маршрутизатора EcoRouter, научиться настраивать интерфейсы, DHCP сервер и NAT трансляцию для обеспечения доступа в сеть Интернет.

## Схема сети:

![alt text](http://url/to/img.png)

## Таблица адресации:

| Устройство | Интерфейс | IP-адрес | Маска подсети | Шлюз по умолчанию | Описание |
|------------|-----------|----------|---------------|------------------|----------|
| ISP Router | to-internet | DHCP | - | - | Подключение к Интернету |
| EcoRouter | to-internet | 10.0.0.1 | /30 | - | Внешний интерфейс |
| EcoRouter | to-lan | 192.168.1.1 | /24 | - | Внутренний интерфейс |
| PC1 | eth0 | 192.168.1.10 | /24 | 192.168.1.1 | Клиентская машина 1 |
| PC2 | eth0 | 192.168.1.11 | /24 | 192.168.1.1 | Клиентская машина 2 |
| Server | eth0 | 192.168.1.100 | /24 | 192.168.1.1 | Локальный сервер |

## Задачи лабораторной работы:

1. **Настройка IP-адресации** на всех устройствах сети
2. **Настройка DHCP сервера** для автоматической выдачи адресов клиентам в сети hq
3. **Настройка NAT трансляции** для обеспечения доступа в Интернет
4. **Проверка работоспособности** сети

## Ход выполнения работы:

### Шаг 1. Подготовка к работе

1.1. Изучить документацию по командам EcoRouter
1.2. Подготовить схему сети согласно таблице адресации
1.3. Войти в режим конфигурации маршрутизатора

### Шаг 2. Настройка базовой конфигурации

#### 2.1. Настройка hostname

```bash
configure terminal
hostname ecorouter-lab
```

#### 2.2. Создание интерфейсов

```bash
# Создание интерфейса для локальной сети
interface e1
ip address 192.168.1.1/24
no shutdown
description Local Network Interface

# Создание интерфейса для внешней сети
interface e2
ip address 10.0.0.1/30
no shutdown
description Internet Interface

# Создание loopback интерфейса
interface loopback.0
ip address 1.1.1.1/32
no shutdown
description Management Interface
```

#### 2.3. Настройка портов и сервисных интерфейсов

```bash
# Настройка порта для локальной сети
port ge0
service-instance lan
encapsulation untagged
connect ip interface e1

# Настройка порта для внешней сети
port ge1
service-instance wan
encapsulation untagged
connect ip interface e2
```

### Шаг 3. Настройка DHCP сервера

#### 3.1. Создание пула адресов

```bash
# Создание пула IP-адресов для клиентов
ip pool CLIENT_POOL 192.168.1.100-192.168.1.200
```

#### 3.2. Настройка DHCP сервера

```bash
# Создание DHCP сервера
dhcp-server 1

# Настройка пула адресов
pool CLIENT_POOL 10
mask 24
gateway 192.168.1.1
dns 8.8.8.8 8.8.4.4
lease 3600

# Привязка сервера к интерфейсу локальной сети
interface e1
dhcp-server 1
```

### Шаг 4. Настройка NAT трансляции

#### 4.1. Настройка интерфейсов для NAT

```bash
# Настройка внутреннего интерфейса
interface e1
ip nat inside

# Настройка внешнего интерфейса
interface e2
ip nat outside
```

#### 4.2. Создание пула адресов для трансляции

```bash
# Создание пула внешних адресов
ip nat pool INTERNET_POOL 10.0.0.100-10.0.0.200
```

#### 4.3. Настройка динамической трансляции с перегрузкой

```bash
# Настройка PAT (Port Address Translation)
ip nat source dynamic inside pool INTERNET_POOL overload 10.0.0.1
```


### Шаг 5. Проверка конфигурации

#### 5.1. Проверка интерфейсов

```bash
show interface
show interface brief
show port
```

#### 5.2. Проверка DHCP сервера

```bash
show dhcp-server clients e1
show ip pool
```

#### 5.3. Проверка NAT трансляции

```bash
show ip nat translations
```

#### 5.4. Проверка таблицы маршрутизации

```bash
show ip route
```

#### 5.5. Диагностика сети

```bash
# Проверка подключенных пользователей
show users connected

# Проверка логов
show log

# Пинг локальных устройств
ping 192.168.1.10
ping 192.168.1.100

# Пинг внешних ресурсов
ping 8.8.8.8
ping ya.ru
```

## Контрольные вопросы:

1. **Что такое сервисный интерфейс (service-instance) и зачем он нужен?**
2. **В чем разница между статической и динамической NAT трансляцией?**
3. **Как работает DHCP relay и когда он используется?**
4. **Что такое PAT и зачем он нужен?**
5. **Какие команды используются для диагностики сети в EcoRouter?**

## Критерии оценки:

Работа считается выполненной, если:

- [ ] Настроена IP-адресация на всех интерфейсах
- [ ] DHCP сервер корректно выдает адреса клиентам
- [ ] NAT трансляция работает в обе стороны
- [ ] Клиенты локальной сети могут пинговать внешние ресурсы
- [ ] Локальный сервер доступен из Интернета по проброшенным портам

## Дополнительные задания:

1. **Настройка статических записей в DHCP** для конкретных MAC-адресов
2. **Настройка ограничения скорости** для разных клиентов

## Примечания:

- Все изменения конфигурации сохраняйте командой `write memory`
- Перед внесением изменений создайте резервную копию конфигурации
- Используйте команду `show running-config` для просмотра текущей конфигурации
- Для получения справки по командам используйте `?` после части команды
